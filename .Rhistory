xlab('Edu')+
ylab('precentage of frequently')+
ggtitle('edu for people who are unemployed')
unique(df$job
)
table(df$job)
for i in range(41188):
if df['education'][i] == 'unknown' and df['job'][i]== 'blue-collar':
df['education'][i]= 'basic.6y'
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'admin.') {
df$education[i]= 'university.degree'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'technician') {
df$education[i]= 'professional.course'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'student') {
df$education[i]= 'high.school'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'unknown') {
df$education[i]= 'basic.4y'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'management') {
df$education[i]= 'university.degree'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'retired') {
df$education[i]= 'basic.4y'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'blue-collar') {
df$education[i]= 'basic.6y'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'housemaid') {
df$education[i]= 'basic.4y'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'entrepreneur') {
df$education[i]= 'university.degree'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'self-employed') {
df$education[i]= 'university.degree'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'unemployed') {
df$education[i]= 'university.degree'
}
}
table(df$education)
table(df$default)
ggplot(df, aes(x= default))+
geom_bar(width = 0.5)+
ggtitle('frequently of default')
default.agg <- aggregate(df$y.1, by= list(df$default), FUN= mean)
ggplot(default.agg ,aes(x= Group.1, y= x))+
geom_bar(stat = 'identity', width = 0.5)+
xlab('Default')+
ylab('percentage of people who said yes')
housing.agg <- aggregate(df$y.1, by= list(df$housing), FUN= mean)
ggplot(housing.agg, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity', width = 0.5)+
xlab('Housing')+
ylab('percentage of people who said yes')
loan.agg <- aggregate(df$y.1, by= list(df$loan), FUN= mean)
ggplot(loan.agg, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity', width = 0.5)+
xlab('loan')+
ylab('percentage of people who said yes')
contact.agg <- aggregate(df$y.1, by= list(df$contact), FUN= mean)
ggplot(contact.agg, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity', width = 0.3)+
xlab('contact')+
ylab('percentage of people who said yes')
ggplot(df, aes(x= as.factor(y.1), y= campaign))+
geom_boxplot()+
xlab('y')+
ylim(0, 10)
pdays.agg <- aggregate(df$pdays, by= list(df$y.1), FUN= mean)
ggplot(pdays.agg, aes(x=as.factor(Group.1), y= x))+
geom_bar(stat = 'identity', width = 0.35)+
xlab('y')+
ylab('mean of pdays')
agg.month <- aggregate(df$y.1, by= list(df$month), FUN= mean)
ggplot(agg.month, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
xlab('Month')+
ylab('percent of people who was yes')
agg.week <- aggregate(df$y.1, by= list(df$day_of_week), FUN= mean)
ggplot(agg.week, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
xlab('DAY OF WEEK')+
ylab('percent of people who was yes')
for (i in 1:nrow(df)) {
if (df$previous[i]== 4 | df$previous[i]== 5 | df$previous[i]== 6 | df$previous[i]== 7) {
df$previous[i]= 4.5
}
}
agg.previous <- aggregate(df$y.1, by= list(df$previous), FUN= mean)
ggplot(agg.previous, aes(x=as.factor(Group.1), y= x))+
geom_bar(stat = 'identity', width = 0.35)+
xlab('previous')+
ylab('percent of people who was yes')
agg.poutcome <- aggregate(df$y.1, by= list(df$poutcome), FUN= mean)
ggplot(agg.poutcome, aes(x=as.factor(Group.1), y= x))+
geom_bar(stat = 'identity', width = 0.35)+
xlab('Poutcome')+
ylab('percent of people who was yes')
df$emp.var.rate
ggplot(df, aes(x= y, y= emp.var.rate))+
geom_boxplot(width= .33)
ggplot(df, aes(x= y, y= cons.price.idx))+
geom_boxplot(width= .33)
ggplot(df, aes(x= y, y= cons.cof.idx))+
geom_boxplot(width= .33)
ggplot(df, aes(x= y, y= cons.conf.idx))+
geom_boxplot(width= .33)
ggplot(df, aes(x= y, y= euribor3m))+
geom_boxplot(width= .33)
cons.conf.idx
ggplot(df, aes(x= y, y= cons.conf.idx))+
geom_boxplot(width= .33)
ggplot(df, aes(x= y, y= euribor3m))+
geom_boxplot(width= .33)
ggplot(df, aes(x= y, y= nr.employed))+
geom_boxplot(width= .33)
df$age= (df$age-mean(df$age))/(max(df$age)-min(df$age))
df$age= (df$age-mean(df$age))/(max(df$age)-min(df$age))
df$campaign= (df$campaign-mean(df$campaign))/(max(df$campaign)-min(df$campaign))
df$pdays= (df$pdays-mean(df$pdays))/(max(df$pdays)-min(df$pdays))
df$previous= (df$previous-mean(df$previous))/(max(df$previous)-min(df$previous))
df$emp.var.rate= (df$emp.var.rate-mean(df$emp.var.rate))/(max(df$emp.var.rate)-min(df$emp.var.rate))
df$cons.price.idx= (df$cons.price.idx-mean(df$cons.price.idx))/(max(df$cons.price.idx)-min(df$cons.price.idx))
df$cons.conf.idx= (df$cons.conf.idx-mean(df$cons.conf.idx))/(max(df$cons.conf.idx)-min(df$cons.conf.idx))
df$euribor3m= (df$euribor3m-mean(df$euribor3m))/(max(df$euribor3m)-min(df$euribor3m))
df$nr.employed= (df$nr.employed-mean(df$nr.employed))/(max(df$nr.employed)-min(df$nr.employed))
df.numeric <- df[, 'age']
df.numeric <- df[, 'age', 'campaign']
df.numeric <- df[, c('age', 'campaign')]
df.numeric <- df[, c('age', 'campaign', 'pdays', 'previous', 'emp.var.rate', 'cons.price.idx', 'cons.conf.idx',
'euribor3m', 'nr.employed')]
View(df.numeric)
cor(df.numeric, method = c('person', 'kendall', 'spearman'))
cor(df.numeric, method = c('person'))
cor(df.numeric, method = 'person')
cor(df.numeric, method = 'pearson')
cor.mat<- cor(df.numeric, method = 'pearson')
library(reshape)
cor.mat<- round(cor.mat, 3)
cor.mat<- round(cor.mat, 2)
melted.cor.mat<- melt(cor.mat)
ggplot(melted.cor.mat, aes(x= X1, y= X2, fill= value))+
geom_tile()+
geom_text(aes(x= X1, y= X2, label= value))
df <- read.csv('bank-additional-full.csv',sep = ';',header = TRUE)
library(ggplot2)
ggplot(df, aes(x= age, fill= y))+
geom_histogram()+
ggtitle('نمودار فراوانی سن')
str(df$age)
quantile(df$age, probs= c(.25, .5, .75), names = TRUE)
for (i in 1:nrow(df)) {
if (df$age[i]<32) {
df$age[i]= 25
}else if (df$age[i]>= 32& df$age[i]<= 47) {
df$age[i]= 40
}else if (df$age[i]>47) {
df$age[i]= 72
}
}
unique(df$age)
table(df$age)
ggplot(df, aes(x= age, fill= y))+
geom_bar()
df$y.1 <- 0
for (i in 1:nrow(df)) {
if (df$y[i] == 'yes') {
df$y.1[i] = 1
}
}
age.agg<- aggregate(df$y.1, by= list(df$age), FUN = mean)
ggplot(age.agg, aes(x= factor(Group.1), y= x))+
geom_bar(stat = 'identity', width = 0.5)+
xlab('age')+
ylab('percent of people who was yes')
ggplot(df, aes(x= job, fill= y))+
geom_bar(width = 0.5)
ggplot(df, aes(x= job))+
facet_wrap(~y)+
geom_bar(width = 0.5)
job.agg <- aggregate(df$y.1, by= list(df$job), FUN= mean)
ggplot(job.agg, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
xlab('Job')+
ylab('percentage of people who said yes')
ggplot(df, aes(x= marital, fill= y))+
geom_bar(width = 0.5)
table(df$marital)
martial.agg<- aggregate(df$y.1, by= list(df$marital),FUN= mean)
ggplot(martial.agg, aes(x= Group.1, y= x))+
geom_bar(stat= 'identity', width = 0.5)+
xlab('Martial')+
ylab('percentage of people who said yes')
ggplot(df, aes(x= education, fill= y))+
geom_bar()
table(df$education)
edu.agg <- aggregate(df$y.1, by= list(df$education),FUN= mean)
ggplot(edu.agg, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
ylab('percentage of people who said yes')+
xlab('eduacarion')
df$just.one <- 1
eduvsjob.agg<- aggregate(df$just.one, by= list(df$education,df$job),FUN= sum,drop= FALSE)
# j= 0
# for (i in 1:nrow(df)) {
#   if (df$education[i]== 'basic.4y' & df$job[i]== 'admin.') {
#     j= j+1
#   }
# }
# j
#What is the jobs frequently for people that their edu is unknopwn:
unknown.edu <- eduvsjob.agg[which(eduvsjob.agg$Group.1== 'unknown'),]
#wha is the edu for people whose job is bluecollar:
bluecollar.edu <- eduvsjob.agg[which(eduvsjob.agg$Group.2== 'blue-collar'),]
ggplot(bluecollar.edu, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
xlab('edu')+
ylab('frequently')+
ggtitle('blue-collar')
ggplot(unknown.edu, aes(x= Group.2, y= x))+
geom_bar(stat = 'identity')+
ylab('frequently')+
xlab('job')+
ggtitle('people with unknown edu')
table(df$education)
admin.edu <- eduvsjob.agg[which(eduvsjob.agg$Group.2== 'admin.'),]
admin.edu$x[1] <- admin.edu$x[1]/4176
admin.edu$x[2] <- admin.edu$x[2]/2292
admin.edu$x[3] <- admin.edu$x[3]/6045
admin.edu$x[4] <- admin.edu$x[4]/9515
admin.edu$x[5] <- admin.edu$x[5]/18
admin.edu$x[6] <- admin.edu$x[6]/5243
admin.edu$x[7] <- admin.edu$x[7]/12168
admin.edu$x[8] <- admin.edu$x[8]/1731
ggplot(admin.edu, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
xlab('Edu')+
ylab('precentage of frequently')+
ggtitle('edu for people who are admin')
aa<- table(df$education)
aa
aa$basic.47
aa[1]
#technician
technician.edu <- eduvsjob.agg[eduvsjob.agg$Group.2== 'technician',]
for (i in 1:8) {
technician.edu$x[i]<- technician.edu$x[i]/aa[i]
}
ggplot(technician.edu, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
xlab('Edu')+
ylab('precentage of frequently')+
ggtitle('edu for people who are technician')
student.edu <- eduvsjob.agg[eduvsjob.agg$Group.2=='student',]
for (i in 1:8) {
student.edu$x[i]<- student.edu$x[i]/aa[i]
}
ggplot(student.edu, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
xlab('Edu')+
ylab('precentage of frequently')+
ggtitle('edu for people who are student')
services.edu <- eduvsjob.agg[eduvsjob.agg$Group.2=='services',]
for (i in 1:8) {
services.edu$x[i]<- services.edu$x[i]/aa[i]
}
ggplot(services.edu, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
xlab('Edu')+
ylab('precentage of frequently')+
ggtitle('edu for people who are services')
unknownjob.edu <- eduvsjob.agg[eduvsjob.agg$Group.2=='unknown',]
for (i in 1:8) {
unknownjob.edu$x[i]<- unknownjob.edu$x[i]/aa[i]
}
ggplot(unknownjob.edu, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
xlab('Edu')+
ylab('precentage of frequently')+
ggtitle('edu for people whose job are unknown')
management.edu <- eduvsjob.agg[eduvsjob.agg$Group.2=='management',]
for (i in 1:8) {
management.edu$x[i]<- management.edu$x[i]/aa[i]
}
ggplot(management.edu, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
xlab('Edu')+
ylab('precentage of frequently')+
ggtitle('edu for people who are management')
retired.edu <- eduvsjob.agg[eduvsjob.agg$Group.2=='retired',]
for (i in 1:8) {
retired.edu$x[i]<- retired.edu$x[i]/aa[i]
}
ggplot(retired.edu, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
xlab('Edu')+
ylab('precentage of frequently')+
ggtitle('edu for people who are retired')
housemaid.edu <- eduvsjob.agg[eduvsjob.agg$Group.2=='housemaid',]
for (i in 1:8) {
housemaid.edu$x[i]<- housemaid.edu$x[i]/aa[i]
}
ggplot(housemaid.edu, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
xlab('Edu')+
ylab('precentage of frequently')+
ggtitle('edu for people who are housemaid')
entrepreneur.edu <- eduvsjob.agg[eduvsjob.agg$Group.2=='entrepreneur',]
for (i in 1:8) {
entrepreneur.edu$x[i]<- entrepreneur.edu$x[i]/aa[i]
}
ggplot(entrepreneur.edu, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
xlab('Edu')+
ylab('precentage of frequently')+
ggtitle('edu for people who are entrepreneur')
selfEmployed.edu <- eduvsjob.agg[eduvsjob.agg$Group.2=='self-employed',]
for (i in 1:8) {
selfEmployed.edu$x[i]<- selfEmployed.edu$x[i]/aa[i]
}
ggplot(selfEmployed.edu, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
xlab('Edu')+
ylab('precentage of frequently')+
ggtitle('edu for people who are self-employed')
unemployed.edu <- eduvsjob.agg[eduvsjob.agg$Group.2=='unemployed',]
for (i in 1:8) {
unemployed.edu$x[i]<- unemployed.edu$x[i]/aa[i]
}
ggplot(unemployed.edu, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
xlab('Edu')+
ylab('precentage of frequently')+
ggtitle('edu for people who are unemployed')
unique(df$job
)
table(df$job)
for i in range(41188):
if df['education'][i] == 'unknown' and df['job'][i]== 'blue-collar':
df['education'][i]= 'basic.6y'
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'admin.') {
df$education[i]= 'university.degree'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'technician') {
df$education[i]= 'professional.course'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'student') {
df$education[i]= 'high.school'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'unknown') {
df$education[i]= 'basic.4y'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'management') {
df$education[i]= 'university.degree'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'retired') {
df$education[i]= 'basic.4y'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'blue-collar') {
df$education[i]= 'basic.6y'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'housemaid') {
df$education[i]= 'basic.4y'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'entrepreneur') {
df$education[i]= 'university.degree'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'self-employed') {
df$education[i]= 'university.degree'
}
}
for (i in 1:nrow(df)) {
if (df$education[i]== 'unknown'& df$job[i]== 'unemployed') {
df$education[i]= 'university.degree'
}
}
table(df$education)
table(df$default)
ggplot(df, aes(x= default))+
geom_bar(width = 0.5)+
ggtitle('frequently of default')
default.agg <- aggregate(df$y.1, by= list(df$default), FUN= mean)
ggplot(default.agg ,aes(x= Group.1, y= x))+
geom_bar(stat = 'identity', width = 0.5)+
xlab('Default')+
ylab('percentage of people who said yes')
housing.agg <- aggregate(df$y.1, by= list(df$housing), FUN= mean)
ggplot(housing.agg, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity', width = 0.5)+
xlab('Housing')+
ylab('percentage of people who said yes')
loan.agg <- aggregate(df$y.1, by= list(df$loan), FUN= mean)
ggplot(loan.agg, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity', width = 0.5)+
xlab('loan')+
ylab('percentage of people who said yes')
contact.agg <- aggregate(df$y.1, by= list(df$contact), FUN= mean)
ggplot(contact.agg, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity', width = 0.3)+
xlab('contact')+
ylab('percentage of people who said yes')
ggplot(df, aes(x= as.factor(y.1), y= campaign))+
geom_boxplot()+
xlab('y')+
ylim(0, 10)
pdays.agg <- aggregate(df$pdays, by= list(df$y.1), FUN= mean)
ggplot(pdays.agg, aes(x=as.factor(Group.1), y= x))+
geom_bar(stat = 'identity', width = 0.35)+
xlab('y')+
ylab('mean of pdays')
agg.month <- aggregate(df$y.1, by= list(df$month), FUN= mean)
ggplot(agg.month, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
xlab('Month')+
ylab('percent of people who was yes')
agg.week <- aggregate(df$y.1, by= list(df$day_of_week), FUN= mean)
ggplot(agg.week, aes(x= Group.1, y= x))+
geom_bar(stat = 'identity')+
xlab('DAY OF WEEK')+
ylab('percent of people who was yes')
for (i in 1:nrow(df)) {
if (df$previous[i]== 4 | df$previous[i]== 5 | df$previous[i]== 6 | df$previous[i]== 7) {
df$previous[i]= 4.5
}
}
agg.previous <- aggregate(df$y.1, by= list(df$previous), FUN= mean)
ggplot(agg.previous, aes(x=as.factor(Group.1), y= x))+
geom_bar(stat = 'identity', width = 0.35)+
xlab('previous')+
ylab('percent of people who was yes')
agg.poutcome <- aggregate(df$y.1, by= list(df$poutcome), FUN= mean)
ggplot(agg.poutcome, aes(x=as.factor(Group.1), y= x))+
geom_bar(stat = 'identity', width = 0.35)+
xlab('Poutcome')+
ylab('percent of people who was yes')
#box plots for numeric variables
df$emp.var.rate
ggplot(df, aes(x= y, y= emp.var.rate))+
geom_boxplot(width= .33)
df$cons.conf.idx
ggplot(df, aes(x= y, y= cons.price.idx))+
geom_boxplot(width= .33)
ggplot(df, aes(x= y, y= cons.conf.idx))+
geom_boxplot(width= .33)
ggplot(df, aes(x= y, y= euribor3m))+
geom_boxplot(width= .33)
ggplot(df, aes(x= y, y= nr.employed))+
geom_boxplot(width= .33)
#normalizing numeric variables:
df$age= (df$age-mean(df$age))/(max(df$age)-min(df$age))
df$campaign= (df$campaign-mean(df$campaign))/(max(df$campaign)-min(df$campaign))
df$pdays= (df$pdays-mean(df$pdays))/(max(df$pdays)-min(df$pdays))
df$previous= (df$previous-mean(df$previous))/(max(df$previous)-min(df$previous))
df$emp.var.rate= (df$emp.var.rate-mean(df$emp.var.rate))/(max(df$emp.var.rate)-min(df$emp.var.rate))
df$cons.price.idx= (df$cons.price.idx-mean(df$cons.price.idx))/(max(df$cons.price.idx)-min(df$cons.price.idx))
df$cons.conf.idx= (df$cons.conf.idx-mean(df$cons.conf.idx))/(max(df$cons.conf.idx)-min(df$cons.conf.idx))
df$euribor3m= (df$euribor3m-mean(df$euribor3m))/(max(df$euribor3m)-min(df$euribor3m))
df$nr.employed= (df$nr.employed-mean(df$nr.employed))/(max(df$nr.employed)-min(df$nr.employed))
df.numeric <- df[, c('age', 'campaign', 'pdays', 'previous', 'emp.var.rate', 'cons.price.idx', 'cons.conf.idx',
'euribor3m', 'nr.employed')]
#Heat-Map
cor.mat<- cor(df.numeric, method = 'pearson')
library(reshape)
cor.mat<- round(cor.mat, 2)
melted.cor.mat<- melt(cor.mat)
ggplot(melted.cor.mat, aes(x= X1, y= X2, fill= value))+
geom_tile()+
geom_text(aes(x= X1, y= X2, label= value))
